define(["jquery","shared.main.screen","shared.main.resize","shared.main.overlay"],function(a,t){function n(e,i){this.element=e,this.options=i,this.metadata=a(this.element).data("search-options")}var s="topbarSearch";n.defaults=(n.prototype={defaults:{panelSizes:["small","medium"],screenSize:{previous:"small"}},init:function(){return this.config=a.extend({},this.defaults,this.options,this.metadata),this.config.$searchTopbarJS=a(".title-area .search-topbar-js"),this.config.$masterHeader=a(".master-header"),this._build(),this.events(),this},_build:function(){this.switchResponsiveDisplay()},events:function(){var t=this;a("form.search-form-js").on("submit",function(e){t.sanitizeSearchField()}),a(".title-area .toggle-topbar-js").on("click",function(){t.hideSearchPanel()}),t.initSmallNavSearchButton(),t.initResponsiveButtons(),a.pubsub("subscribe","window.resize.breakpoint",function(e,i){t.switchResponsiveDisplay(),"small"!==i.now&&t.hideSearchPanel()})},showSearchPanel:function(){var i=this;"small"===t.size()&&(a("body").on("click.topBarSearch.dismiss",function(e){0===a(e.target).closest(a(i.element)).length&&(e.preventDefault(),i.hideSearchPanel())}),setTimeout(function(){window.main.overlay.show(),i.config.$masterHeader.addClass("active")},250)),a(i.element).removeClass("hide"),a(i.element).is(":visible")&&a(".search-input-js",a(i.element)).is(":visible")&&a(".search-button-container",a(i.element)).is(":visible")&&a("input#search",i.element).focus(),i.config.$searchTopbarJS.addClass("active")},hideSearchPanel:function(){var e=this;a("body").off("click.topBarSearch.dismiss"),a(e.element).addClass("hide"),"small"===t.size()&&(e.config.$masterHeader.removeClass("active"),window.main.overlay.hide()),e.config.$searchTopbarJS.removeClass("active")},toggleSearchPanel:function(){var e=this;a(e.element).hasClass("hide")?e.showSearchPanel():e.hideSearchPanel()},initSmallNavSearchButton:function(){var i=this;i.config.$searchTopbarJS.on("click",function(e){e.stopPropagation(),0<a(".top-bar-acord.expanded, .top-bar.expanded").length&&a(".title-area .toggle-topbar-js").trigger("click"),i.toggleSearchPanel()})},initResponsiveButtons:function(){var i=this;a("a.search-button",a(i.element).parent()).on("click",function(e){e.preventDefault(),a(i.element).is(":visible")?a(".search-input-js",a(i.element)).is(":visible")&&!a(".search-button-container",a(i.element)).is(":visible")?i.searchButtonSubmit(a(this)):i.hideSearchPanel():i.showSearchPanel()})},switchResponsiveDisplay:function(){var e=this;e.config.screenSize.current=t.size(),e.config.screenSize.previous!==e.config.screenSize.current&&(0<=e.config.panelSizes.indexOf(e.config.screenSize.current)?e.hideSearchPanel():e.showSearchPanel(),e.config.screenSize.previous=t.size())},sanitizeSearchField:function(){var e=a("#search",a(this.element)),i=e.data("filter-chars"),t=new RegExp(i,"gi");i&&e.val(e.val().replace(t,""))},searchButtonSubmit:function(e){var i=e.parent().parent("form").get(0);return i.checkValidity()?(a(i).trigger("submit"),!0):(a(i).find(":submit").trigger("click"),!1)}}).defaults,a.fn.topbarSearch=function(i){return this.each(function(){var e=a(this).data(s);e||(e=new n(this,i).init(),a(this).data(s,e))})}});
//# sourceMappingURL=../../../maps/js/wcs/topbar/topbar-search.hash-9ab4e2e5b0bc2a1518faf936e2452b25.js.map